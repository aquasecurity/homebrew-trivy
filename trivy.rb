# typed: false
# frozen_string_literal: true

# This file was generated by GoReleaser. DO NOT EDIT.
class Trivy < Formula
  desc "Scanner for vulnerabilities in container images, file systems, and Git repositories, as well as for configuration issues"
  homepage "https://github.com/aquasecurity/trivy"
  version "0.43.1"

  on_macos do
    if Hardware::CPU.intel?
      url "https://github.com/aquasecurity/trivy/releases/download/v0.43.1/trivy_0.43.1_macOS-64bit.tar.gz"
      sha256 "ba1eab880dfc9f3e6be3364a7003fb774ec554995ab3c620d8b6d831a9ec9644"

      def install
        bin.install "trivy"
      end
    end
    if Hardware::CPU.arm?
      url "https://github.com/aquasecurity/trivy/releases/download/v0.43.1/trivy_0.43.1_macOS-ARM64.tar.gz"
      sha256 "36ed173ceb38b74fa2e76934112ba944b9a1330dd9b1d4dbfd4258b526a149c6"

      def install
        bin.install "trivy"
      end
    end
  end

  on_linux do
    if Hardware::CPU.intel?
      url "https://github.com/aquasecurity/trivy/releases/download/v0.43.1/trivy_0.43.1_Linux-64bit.tar.gz"
      sha256 "4abb910dc5041165dab5cc1148701f60897389aeba41119a3e47e9215c8fed81"

      def install
        bin.install "trivy"
      end
    end
    if Hardware::CPU.arm? && Hardware::CPU.is_64_bit?
      url "https://github.com/aquasecurity/trivy/releases/download/v0.43.1/trivy_0.43.1_Linux-ARM64.tar.gz"
      sha256 "e33ddba76ed5f142a0261881ebf5f41fcd022544be0e3714396674dc33a5f4f5"

      def install
        bin.install "trivy"
      end
    end
  end

  test do
    system "#{bin}/trivy", "--version"
  end
end
