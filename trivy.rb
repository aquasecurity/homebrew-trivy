# typed: false
# frozen_string_literal: true

# This file was generated by GoReleaser. DO NOT EDIT.
class Trivy < Formula
  desc "Scanner for vulnerabilities in container images, file systems, and Git repositories, as well as for configuration issues"
  homepage "https://github.com/aquasecurity/trivy"
  version "0.51.1"

  on_macos do
    if Hardware::CPU.intel?
      url "https://github.com/aquasecurity/trivy/releases/download/v0.51.1/trivy_0.51.1_macOS-64bit.tar.gz"
      sha256 "1a878048cde5b54f3faf02f7b347dcedc2d5d94043be1766de9175824cb28327"

      def install
        bin.install "trivy"
      end
    end
    if Hardware::CPU.arm?
      url "https://github.com/aquasecurity/trivy/releases/download/v0.51.1/trivy_0.51.1_macOS-ARM64.tar.gz"
      sha256 "f478ef82567479280792edc74085b29f2ae9dc195d6b00c43c467807cb8c7159"

      def install
        bin.install "trivy"
      end
    end
  end

  on_linux do
    if Hardware::CPU.intel?
      url "https://github.com/aquasecurity/trivy/releases/download/v0.51.1/trivy_0.51.1_Linux-64bit.tar.gz"
      sha256 "34caa1113520bb40cd03b31656a25c84ace2dc853a27e6abe43a235784ec7256"

      def install
        bin.install "trivy"
      end
    end
    if Hardware::CPU.arm? && Hardware::CPU.is_64_bit?
      url "https://github.com/aquasecurity/trivy/releases/download/v0.51.1/trivy_0.51.1_Linux-ARM64.tar.gz"
      sha256 "6e1aa727683cd225c00f6c2c1e9e7f0aee3a664332401df658e9e648cf99c595"

      def install
        bin.install "trivy"
      end
    end
  end

  test do
    system "#{bin}/trivy", "--version"
  end
end
