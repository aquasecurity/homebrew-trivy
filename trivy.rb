# typed: false
# frozen_string_literal: true

# This file was generated by GoReleaser. DO NOT EDIT.
class Trivy < Formula
  desc "Scanner for vulnerabilities in container images, file systems, and Git repositories, as well as for configuration issues"
  homepage "https://github.com/aquasecurity/trivy"
  version "0.47.0"

  on_macos do
    if Hardware::CPU.arm?
      url "https://github.com/aquasecurity/trivy/releases/download/v0.47.0/trivy_0.47.0_macOS-ARM64.tar.gz"
      sha256 "9cb1e027fc7d6dfb4817435749ac4117ba4105065a9c95e02fd86a4e14a82974"

      def install
        bin.install "trivy"
      end
    end
    if Hardware::CPU.intel?
      url "https://github.com/aquasecurity/trivy/releases/download/v0.47.0/trivy_0.47.0_macOS-64bit.tar.gz"
      sha256 "43f909599d08d2c1bf84611f668d43dcd69f95d42d15f49ed923ab7c3329777c"

      def install
        bin.install "trivy"
      end
    end
  end

  on_linux do
    if Hardware::CPU.arm? && Hardware::CPU.is_64_bit?
      url "https://github.com/aquasecurity/trivy/releases/download/v0.47.0/trivy_0.47.0_Linux-ARM64.tar.gz"
      sha256 "7628277d2b0d2e57d9c81f0d7dc299d661a972b0d96978bd06518e9adbe70831"

      def install
        bin.install "trivy"
      end
    end
    if Hardware::CPU.intel?
      url "https://github.com/aquasecurity/trivy/releases/download/v0.47.0/trivy_0.47.0_Linux-64bit.tar.gz"
      sha256 "cf14a06801d3130122c1ab7b3f58c5d0c52f7d00edbb1455883f3dee18b571ea"

      def install
        bin.install "trivy"
      end
    end
  end

  test do
    system "#{bin}/trivy", "--version"
  end
end
