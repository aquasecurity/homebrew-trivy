# typed: false
# frozen_string_literal: true

# This file was generated by GoReleaser. DO NOT EDIT.
class Trivy < Formula
  desc "Scanner for vulnerabilities in container images, file systems, and Git repositories, as well as for configuration issues"
  homepage "https://github.com/aquasecurity/trivy"
  version "0.48.1"

  on_macos do
    if Hardware::CPU.arm?
      url "https://github.com/aquasecurity/trivy/releases/download/v0.48.1/trivy_0.48.1_macOS-ARM64.tar.gz"
      sha256 "eb51623fc1eeddc7a742e4dc2118a7fb0a8e1cb59b58e470c2ba03ef1cbb8ff9"

      def install
        bin.install "trivy"
      end
    end
    if Hardware::CPU.intel?
      url "https://github.com/aquasecurity/trivy/releases/download/v0.48.1/trivy_0.48.1_macOS-64bit.tar.gz"
      sha256 "82c1e17e2e4b3330707db580771792ec160314a4e485e1b0b36b90d6d51b5d5b"

      def install
        bin.install "trivy"
      end
    end
  end

  on_linux do
    if Hardware::CPU.arm? && Hardware::CPU.is_64_bit?
      url "https://github.com/aquasecurity/trivy/releases/download/v0.48.1/trivy_0.48.1_Linux-ARM64.tar.gz"
      sha256 "78fa22c268cfff4967355aded23ecbab728b3fc33ab9b0689a2f6a70ad74449f"

      def install
        bin.install "trivy"
      end
    end
    if Hardware::CPU.intel?
      url "https://github.com/aquasecurity/trivy/releases/download/v0.48.1/trivy_0.48.1_Linux-64bit.tar.gz"
      sha256 "c111b6b6ce427b39dd2ec06eea5754d2b5afe249eb7436294b4aa4ad36bc47d9"

      def install
        bin.install "trivy"
      end
    end
  end

  test do
    system "#{bin}/trivy", "--version"
  end
end
