# typed: false
# frozen_string_literal: true

# This file was generated by GoReleaser. DO NOT EDIT.
class Trivy < Formula
  desc "Scanner for vulnerabilities in container images, file systems, and Git repositories, as well as for configuration issues"
  homepage "https://github.com/aquasecurity/trivy"
  version "0.63.0"

  on_macos do
    on_intel do
      url "https://github.com/aquasecurity/trivy/releases/download/v0.63.0/trivy_0.63.0_macOS-64bit.tar.gz"
      sha256 "01659b540a885ee9bd1273c8c75ade1ce046fc9d6e5933d5978d9125a6a1cf6c"

      def install
        bin.install "trivy"
      end
    end
    on_arm do
      url "https://github.com/aquasecurity/trivy/releases/download/v0.63.0/trivy_0.63.0_macOS-ARM64.tar.gz"
      sha256 "784f687759c647ffad54e4d7f55ed953647e4fff5ea1e38dbaf877a135254972"

      def install
        bin.install "trivy"
      end
    end
  end

  on_linux do
    on_intel do
      if Hardware::CPU.is_64_bit?
        url "https://github.com/aquasecurity/trivy/releases/download/v0.63.0/trivy_0.63.0_Linux-64bit.tar.gz"
        sha256 "ea91fa393cfcb802da22832c96e99a4c8a295a8ba8faefd824c7168b7f0a741e"

        def install
          bin.install "trivy"
        end
      end
    end
    on_arm do
      if Hardware::CPU.is_64_bit?
        url "https://github.com/aquasecurity/trivy/releases/download/v0.63.0/trivy_0.63.0_Linux-ARM64.tar.gz"
        sha256 "9aeecf81e8a1dc5625dd96a1a6fbea92a1f8e51c4160cfc0e412ef5f641ea1ac"

        def install
          bin.install "trivy"
        end
      end
    end
  end

  test do
    system "#{bin}/trivy", "--version"
  end
end
